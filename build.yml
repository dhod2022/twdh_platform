name: build
on: 
  push: 
    branches: 
      - main # pushåˆ°main branchå°±è§¸ç™¼æµç¨‹
jobs:
  build-and-deploy:
    runs-on: Windows Server 2019
    steps:
      # githubå®˜æ–¹çš„ä¸€å€‹actionï¼Œç”¨æ–¼cloneè©²å€‰åº«çš„codeåˆ°å·¥ä½œæµä¸­ï¼Œ
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v2
        with:
          persist-credentials: false
        - uses: borales/actions-yarn@v3.0.0
        with:
          cmd: install # will run `yarn install` command
    
      # æŒ‡å®š node ç‰ˆæœ¬
      - uses: actions/setup-node@v2 
        with:
          node-version: '16'

      - name: Build
        run: |
          npm -g i yarn
          cd twdh_platform 
          yarn install  
          yarn build 
  
      # é€£æ¥åˆ°sshï¼Œä¸¦ä¸”åšè¤‡è£½æ“ä½œçš„action
      - name: Deploy ğŸš€
        uses: cross-the-world/scp-pipeline@master
        env:
          WELCOME: "ssh scp ssh pipelines"
          LASTSSH: "Doing something after copying"
        with:
         host: ${{ secrets.DR_HOST }}
         user: ${{ secrets.DR_USER }}
         pass: ${{ secrets.DR_PASS }}
         connect_timeout: 10s
         local: './twdh_platform/dist/*' # ä¸‹ä¸€æ­¥è¦å‰µå»ºçš„vueé …ç›®æ§‹å»ºå®Œæˆå¾Œçš„é™æ…‹è³‡æºè·¯å¾‘
         remote: /www/actionTest # step1 ä¸­ï¼Œåœ¨Serverä¸Šå‰µå»ºç”¨æ–¼å­˜æ”¾é™æ…‹è³‡æºçš„è³‡æ–™å¤¾




name: build
on: [main]
jobs:
  build-and-deploy:
    runs-on: Windows Server 2019
    steps:
      - uses: actions/checkout@v2
      - uses: borales/actions-yarn@v3.0.0
        with:
          cmd: install # will run `yarn install` command
      - uses: borales/actions-yarn@v3.0.0
        with:
          cmd: build # will run `yarn build` command
      # - uses: borales/actions-yarn@v3.0.0
        # with:
          # cmd: test # will run `yarn test` command

    steps:
      # githubå®˜æ–¹çš„ä¸€å€‹actionï¼Œç”¨æ–¼cloneè©²å€‰åº«çš„codeåˆ°å·¥ä½œæµä¸­ï¼Œ
      - name: Checkout
        uses: actions/checkout@v2
        with:
          persist-credentials: false
        - uses: borales/actions-yarn@v3.0.0
        with:
          cmd: install # will run `yarn install` command
    
      # æŒ‡å®š node ç‰ˆæœ¬
      - uses: actions/setup-node@v2 
        with:
          node-version: '16'

      - name: Build
        run: |
          npm -g i yarn
          cd twdh_platform 
          yarn install  
          yarn build 
  
      # é€£æ¥åˆ°sshï¼Œä¸¦ä¸”åšè¤‡è£½æ“ä½œçš„action
      - name: Deploy
        uses: cross-the-world/scp-pipeline@master
        env:
          WELCOME: "ssh scp ssh pipelines"
          LASTSSH: "Doing something after copying"
        with:
         host: ${{ secrets.DR_HOST }}
         user: ${{ secrets.DR_USER }}
         pass: ${{ secrets.DR_PASS }}
         connect_timeout: 10s
         local: './twdh_platform/dist/*' # ä¸‹ä¸€æ­¥è¦å‰µå»ºçš„vueé …ç›®æ§‹å»ºå®Œæˆå¾Œçš„é™æ…‹è³‡æºè·¯å¾‘
         remote: /www/actionTest # step1 ä¸­ï¼Œåœ¨Serverä¸Šå‰µå»ºç”¨æ–¼å­˜æ”¾é™æ…‹è³‡æºçš„è³‡æ–™å¤¾

